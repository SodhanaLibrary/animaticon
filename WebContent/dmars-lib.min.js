"use strict";var _createClass=function(){function s(t,i){for(var o=0;o<i.length;o++){var s=i[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,i,o){return i&&s(t.prototype,i),o&&s(t,o),t}}();function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var AnimaticonObj3=function(){function z(t){var s=this,i=t.animaticonObjName,o=t.name,e=t.tags,n=t.uuid,r=t.objJson,a=t.img,u=t.bones,h=t.paths,l=t.groupId,p=t.scene,c=t.position,g=void 0===c?{x:0,y:0,z:0}:c,f=t.scale,b=void 0===f?{x:1,y:1,z:1}:f,d=t.rotation,m=void 0===d?{x:0,y:0,z:0}:d,v=t.visible,y=void 0===v||v;_classCallCheck(this,z);var k=u,w=h;if(this.scene=p,!k&&!w){var E=JSON.parse(r);k=E.bones,w=E.paths,g=E.position||g,b=E.scale||b}if(this.props={position:g,scale:b,rotation:m,visible:y},this.groupId=l,this.animaticonObjName=i,this.name=o,this.tags=e,this.uuid=n,this.img=a,this.id=-1,this.sbones=[],this.group=new THREE.Group,this.bones=k?k.map(function(t,i){t.group=s.group;var o=new window.animaticonObjects.Bone3(t);return s.sbones.push(o.bone),o}):[],this.paths=w?w.map(function(t,i){return t.group=s.group,t.scene=p,new window.animaticonObjects.PathObj3(t)}):[],this.bones.forEach(function(o){o.props.bones.forEach(function(i){var t=s.bones.find(function(t){return t.props.id===i});o.addBone(t)}),o.props.paths.forEach(function(i){var t=s.paths.find(function(t){return t.props.id===i});o.addPath(t)})}),0<this.sbones.length){var x=new THREE.Skeleton(this.sbones);this.skeletonHelper=new THREE.SkeletonHelper(x.bones[0]),this.skeletonHelper.skeleton=x,this.group.add(x.bones[0]),p.add(this.skeletonHelper),this.skeletonHelper.visible=!1}else this.paths.forEach(function(t){s.group.add(t.path)});p.add(this.group),this.init()}return _createClass(z,[{key:"setId",value:function(t){this.id=t}},{key:"addPath",value:function(t){this.paths.push(t),this.group.add(t.path),this.allMusles=null}},{key:"setGroupId",value:function(t){this.groupId=t}},{key:"showHideRotationPoints",value:function(i){this.bones.forEach(function(t){return t.showHideRotationPoints(i)})}},{key:"init",value:function(){var t=this.props,i=t.position,o=t.scale,s=t.visible,e=t.rotation;this.bones.forEach(function(t){t.init()}),this.paths.forEach(function(t){t.init()}),this.group.position.x=i.x,this.group.position.y=i.y,this.group.position.z=i.z,this.group.scale.x=o.x,this.group.scale.y=o.y,this.group.scale.z=o.z,this.group.rotation.x=e.x,this.group.rotation.y=e.y,this.group.rotation.z=e.z,this.group.visible=s}},{key:"updateProps",value:function(){this.props.scale={x:this.group.scale.x,y:this.group.scale.y,z:this.group.scale.z},this.props.position={x:this.group.position.x,y:this.group.position.y,z:this.group.position.z}}},{key:"setColor",value:function(t){var i=t.fillColor,o=t.strokeColor,s=t.bgColor;this.bones.forEach(function(t){t.setColor({fillColor:i,strokeColor:o,bgColor:s})}),this.paths.forEach(function(t){t.setColor({fillColor:i,strokeColor:o,bgColor:s})})}},{key:"remove",value:function(){this.group.parent&&(this.group.parent.remove(this.skeletonHelper),this.group.parent.remove(this.group))}},{key:"addBone",value:function(){var t=new window.animaticonObjects.Bone3({id:"new One",name:"new One"});this.bones.push(t),this.sbones.push(t.bone),this.scene.remove(this.skeletonHelper),this.scene.remove(this.group),this.group=new THREE.Group;var i=new THREE.Skeleton(this.sbones);return this.skeletonHelper=new THREE.SkeletonHelper(i.bones[0]),this.skeletonHelper.skeleton=i,this.group.add(i.bones[0]),this.scene.add(this.skeletonHelper),this.scene.add(this.group),this.bones.forEach(function(t){return t.init()}),this.formAllMusles(),t}},{key:"getAllMusles",value:function(){return this.allMusles||this.formAllMusles(),this.allMusles}},{key:"formAllMusles",value:function(){this.allMusles=this.bones.map(function(t){return t.muslePath}).filter(function(t){return t}),this.allMusles=this.allMusles.concat(this.paths.map(function(t){return t.path}))}},{key:"getAllRotationPoints",value:function(){return this.rotationPoints||this.formAllRotationPoints(),this.rotationPoints}},{key:"formAllRotationPoints",value:function(){this.rotationPoints=this.bones.map(function(t){return t.rotationPoint}).filter(function(t){return t})}},{key:"clone",value:function(){var t=this.getProperties();return t.position.x+=30,t.position.y+=30,t.id+="1",t.name+="1",t.scene=this.scene,new window.animaticonObjects.AnimaticonObj3(t)}},{key:"getProperties",value:function(){return{bones:this.bones.map(function(t){return t.getProperties()}),paths:this.paths.map(function(t){return t.getProperties()}),animaticonObjName:this.animaticonObjName,name:this.name,tags:this.tags,uuid:this.uuid,groupId:this.groupId,img:this.img,position:{x:this.group.position.x,y:this.group.position.y,z:this.group.position.z},scale:{x:this.group.scale.x,y:this.group.scale.y,z:this.group.scale.z}}}},{key:"getControls",value:function(){return{bones:this.bones,paths:this.paths,animaticonObjName:this.animaticonObjName,name:this.name,tags:this.tags,uuid:this.uuid,img:this.img,groupId:this.groupId,position:{x:this.group.position.x,y:this.group.position.y,z:this.group.position.z},scale:{x:this.group.scale.x,y:this.group.scale.y,z:this.group.scale.z},visible:this.group.visible}}}]),z}();window.animaticonObjects.AnimaticonObj3=AnimaticonObj3;
"use strict";var AnimaticonUtils={animateVector3:function(n,e,a){a=a||{};var t=e||THREE.Vector3(),o=a.easing||TWEEN.Easing.Linear.None,i=a.duration||2e3;return new TWEEN.Tween(n).to({x:t.x,y:t.y,z:t.z},i).easing(o).onUpdate(function(n){a.update&&a.update(n)}).onComplete(function(){a.callback&&a.callback()})},tweenCustomVar:function(n,e,a){console.log(n,e,a);var t=(a=a||{}).easing||TWEEN.Easing.Linear.None,o=a.duration||2e3,i={};return i[a.variable||"opacity"]=e,new TWEEN.Tween(n).to(i,o).easing(t).onUpdate(function(n){a.update&&a.update(n)}).onComplete(function(){a.callback&&a.callback()})},readAudioBufferUrl:function(e,n,a){fetch(n,{method:"GET",headers:{"Content-Type":"arraybuffer"}}).then(function(n){n.arrayBuffer().then(function(n){e.decodeAudioData(n,a)})})}};window.animaticonObjects.AnimaticonUtils=AnimaticonUtils;
"use strict";var _createClass=function(){function i(t,o){for(var n=0;n<o.length;n++){var i=o[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,o,n){return o&&i(t.prototype,o),n&&i(t,n),t}}();function _classCallCheck(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}var AudioAnimationControl3=function(){function s(t){var o=t.duration,n=t.startAt,i=t.id,e=t.objUrl,a=t.volume;_classCallCheck(this,s),this.animationControlClass="AudioAnimationControl3",this.done=!1,this.id=i,this.setProps({duration:o,startAt:n,objUrl:e,volume:a}),this.onComplete=this.onComplete.bind(this),this.createSoundSource=this.createSoundSource.bind(this),this.gainNode=window.globalAudioContext.createGain(),this.gainNode.connect(window.globalAudioContext.destination),this.gainNode.connect(window.globalAudioDestination)}return _createClass(s,[{key:"setId",value:function(t){this.id=t}},{key:"setScrean",value:function(t){this.screen=t}},{key:"init",value:function(){this.done=!1,this.started=!1}},{key:"setProps",value:function(t){var o=t.duration,n=t.startAt,i=t.objUrl,e=t.volume;this.duration=parseFloat(o),this.startAt=parseFloat(n),this.objUrl=i,this.volume=e}},{key:"animate",value:function(){this.started||(this.init(),this.started=!0,this.gainNode.gain.value=this.volume,window.animaticonObjects.AnimaticonUtils.readAudioBufferUrl(window.globalAudioContext,this.objUrl,this.createSoundSource))}},{key:"createSoundSource",value:function(t){var o=window.globalAudioContext.createBufferSource();o.buffer=t,o.start(0,0),o.connect(this.gainNode),this.gainNode.complete=this.onComplete,setTimeout(this.onComplete,this.duration)}},{key:"onComplete",value:function(){this.done=!0}},{key:"setStartAt",value:function(t){this.startAt=t}},{key:"setDuration",value:function(t){this.duration=parseFloat(t)}},{key:"getEndAt",value:function(){return this.startAt+this.duration}},{key:"getStartAt",value:function(){return this.startAt}},{key:"showHideRotationPoints",value:function(o){this.bones.forEach(function(t){return t.showHideRotationPoints(o)})}},{key:"toJson",value:function(){return{duration:this.duration,startAt:this.startAt,animationControlClass:"AudioAnimationControl3"}}}]),s}();window.animaticonObjects.AudioAnimationControl3=AudioAnimationControl3;
"use strict";var _createClass=function(){function i(t,o){for(var e=0;e<o.length;e++){var i=o[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,o,e){return o&&i(t.prototype,o),e&&i(t,e),t}}();function _classCallCheck(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}var Bone3=function(){function z(t){var o=t.id,e=t.name,i=t.position,s=void 0===i?{x:0,y:100,z:0}:i,n=t.length,r=void 0===n?100:n,a=t.initAngle,h=void 0===a?0:a,l=t.muscleWidth,u=void 0===l?{start:50,end:50}:l,p=t.joints,d=void 0===p?{start:{radius:-2,strokeColor:"black",strokeWidth:1},end:{radius:-2,strokeColor:"black",strokeWidth:1}}:p,c=t.arc,f=void 0===c?{start:!0,end:!0}:c,v=t.bones,b=void 0===v?[]:v,P=t.border,m=void 0===P?{strokeColor:"0xffffff",strokeWidth:1}:P,k=t.zIndex,y=void 0===k?10:k,E=t.fillColor,C=void 0===E?"0x000000":E,g=t.paths,T=void 0===g?[]:g;_classCallCheck(this,z),this.props={id:o,position:s,name:e,muscleWidth:u,joints:d,border:m,zIndex:y,fillColor:C,bones:b,arc:f,initAngle:h,length:r,paths:T},this.bones=[],this.paths=[],this.bone=new THREE.Bone,this.setup()}return _createClass(z,[{key:"init",value:function(){this.bone.rotation.z=this.props.initAngle,this.bone.position.y=this.props.position.y}},{key:"setPosition",value:function(t){this.props.position=t,this.bone.position.x=t.x,this.bone.position.y=t.y,this.bone.position.z=t.z}},{key:"addBone",value:function(t){t&&(this.bones.push(t),t.setPosition({x:0,y:this.props.length,z:0}),this.bone.add(t.bone))}},{key:"addPath",value:function(o){o&&!this.paths.find(function(t){return t.props.id===o.props.id})&&(this.paths.push(o),this.bone.add(o.path))}},{key:"removeBone",value:function(t){this.bone.remove(t.bone)}},{key:"setAngle",value:function(t){this.bone.rotation.z=t}},{key:"setup",value:function(){this.formMusles()}},{key:"formMusles",value:function(){this.makeMuslePoints()}},{key:"setVertex",value:function(t,o,e){this.bone.rotation.z+=0<o.y?Math.PI/36:-Math.PI/36}},{key:"getProperties",value:function(){return this.props=Object.assign({},this.props,{bones:this.bones.map(function(t){return t.props.id}),paths:this.paths.map(function(t){return t.props.id})}),this.props}},{key:"setColor",value:function(t){var o=t.fillColor,e=t.strokeColor,i=t.bgColor;this.bones.forEach(function(t){t.setColor({fillColor:o,strokeColor:e,bgColor:i})}),this.paths.forEach(function(t){t.setColor({fillColor:o,strokeColor:e,bgColor:i})}),this.muslePath&&o&&(this.props.fillColor=o,this.muslePath.material.color=new THREE.Color(parseInt(o))),this.musleBorderPath&&e&&(this.props.border.strokeColor=e,this.musleBorderPath.material.color=new THREE.Color(parseInt(e)))}},{key:"setProps",value:function(t){var o=this;this.props=Object.assign({},this.props,t),this.bones.forEach(function(t){t.setPosition({x:0,y:o.props.length,z:0})}),this.paths.forEach(function(t){t.setPosition({x:0,y:o.props.length,z:0})}),this.makeMuslePoints(),this.formzIndexes(),this.init()}},{key:"setGroup",value:function(t){this.group=t,this.group.add(this.bone),this.bone.rotation.z=this.initAngle}},{key:"makeMuslePoints",value:function(){var t=this.props,o=t.muscleWidth,e=t.length,i=t.fillColor,s=t.arc,n=t.zIndex,r=t.border;if(this.muslePath&&this.bone.remove(this.muslePath),this.musleBorderPath&&this.bone.remove(this.musleBorderPath),0===o.start||0===o.end)return this.muslePath=null,void(this.musleBorderPath=null);var a=new THREE.Shape;a.moveTo(-o.start/2,0),a.lineTo(-o.end/2,e),s.start?a.absarc(0,e,o.end/2,Math.PI,0,!0):a.lineTo(o.end/2,e),a.lineTo(o.start/2,0),s.end?a.absarc(0,0,o.start/2,2*Math.PI,Math.PI,!0):a.lineTo(o.start/2,0),a.autoClose=!0;var h=new THREE.ShapeGeometry(a),l=new THREE.MeshBasicMaterial({color:parseInt(i)});if(this.muslePath=new THREE.Mesh(h,l),this.bone.add(this.muslePath),0<r.strokeWidth){var u=new THREE.Shape;u.moveTo(-(o.start+3)/2,0),u.lineTo(-(o.end+3)/2,e),s.start?u.absarc(0,e,(o.end+3)/2,Math.PI,0,!0):u.lineTo((o.end+3)/2,e),u.lineTo((o.start+3)/2,0),s.end?u.absarc(0,0,(o.start+3)/2,2*Math.PI,Math.PI,!0):u.lineTo((o.start+3)/2,0),u.autoClose=!0;var p=new THREE.ShapeGeometry(u),d=new THREE.MeshBasicMaterial({color:parseInt(r.strokeColor)});this.musleBorderPath=new THREE.Mesh(p,d),this.bone.add(this.musleBorderPath)}else this.musleBorderPath=null;if(this.rotationPoint)this.rotationPoint.position.y=this.props.length;else{var c=new THREE.MeshBasicMaterial({color:16711680,transparent:!1}),f=new THREE.SphereGeometry(8),v=new THREE.Mesh(f,c);this.rotationPoint=v,this.rotationPoint.position.copy(this.props.position),this.rotationPoint.position.z=n+200,this.rotationPoint.position.y=this.props.length,this.rotationPoint.visible=!1,this.bone.add(this.rotationPoint)}this.formzIndexes()}},{key:"formzIndexes",value:function(){var t=this.props.zIndex;this.muslePath&&(this.muslePath.position.z=t-.1),this.musleBorderPath&&(this.musleBorderPath.position.z=t-.5)}},{key:"showHideRotationPoints",value:function(t){this.rotationPoint&&(this.rotationPoint.visible=t)}},{key:"getAngle",value:function(){return this.bone.rotation.z}},{key:"getLength",value:function(){return this.props.length}},{key:"rotate",value:function(t){this.bone.rotation.z=t}}]),z}();window.animaticonObjects.Bone3=Bone3;
"use strict";var _createClass=function(){function r(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,n,i){return n&&r(t.prototype,n),i&&r(t,i),t}}();function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var GroupAnimationControls3=function(){function a(t){var n=t.duration,i=void 0===n?1:n,r=t.startAt,s=void 0===r?0:r,o=t.id;_classCallCheck(this,a),this.animationControlClass="GroupAnimationControls3",this.id=o,this.controls=[],this.startAt=s,this.setProps({duration:i,startAt:s})}return _createClass(a,[{key:"setScrean",value:function(t){this.screen=t}},{key:"setControls",value:function(t){this.controls=t;var n=Number.MAX_VALUE,i=0;this.controls.forEach(function(t){n=n>t.startAt?t.startAt:n,i=i<t.startAt+t.duration?t.startAt+t.duration:i}),this.startAt=n,this.end=i,this.duration=this.end-this.startAt}},{key:"setId",value:function(t){this.id=t}},{key:"init",value:function(){this.done=!1,this.started=!1,this.controls.forEach(function(t){return t.init()})}},{key:"setProps",value:function(t){var n=t.duration,i=t.startAt;this.setDuration(parseFloat(n)),this.setStartAt(i)}},{key:"animate",value:function(n){if(this.started||(this.init(),this.started=!0),!this.done){var i=!0;this.controls.forEach(function(t){n>t.startAt&&t.animate(n),i=i&&t.done}),this.done=i}}},{key:"setStartAt",value:function(t){var n=t-this.startAt;this.startAt=t,this.controls.forEach(function(t){t.setStartAt(parseFloat(t.startAt)+n)}),this.end=this.startAt+this.duration}},{key:"setDuration",value:function(t){if(this.duration!==t){var n=t/this.duration;this.controls.forEach(function(t){t.setDuration(t.duration*n),t.setStartAt(t.startAt*n)}),this.duration=t}}},{key:"getEndAt",value:function(){return this.startAt+this.duration}},{key:"getStartAt",value:function(){return this.startAt+this.duration}},{key:"toJson",value:function(){return{duration:this.duration,startAt:this.startAt,animationControlClass:"GroupAnimationControls3",controls:this.controls.map(function(t){return t.toJson()})}}}]),a}();window.animaticonObjects.GroupAnimationControls3=GroupAnimationControls3;
"use strict";var _createClass=function(){function a(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,o){return e&&a(t.prototype,e),o&&a(t,o),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var PathAnimationControl3=function(){function h(t){var e=t.duration,o=t.toPath,a=t.startAt,i=t.id,n=t.pathId,r=t.group,s=t.groupId;_classCallCheck(this,h),this.animationControlClass="PathAnimationControl3",this.done=!1,this.id=i,(this.group=r)&&r.paths&&(this.scene=r.scene,this.bodySeg=r.paths.find(function(t){return t.props.id===n})),this.setProps({duration:e,toPath:o,startAt:a,pathId:n}),this.groupId=s,this.onComplete=this.onComplete.bind(this)}return _createClass(h,[{key:"setScrean",value:function(t){this.screen=t}},{key:"setId",value:function(t){this.id=t}},{key:"setGroupId",value:function(t){this.groupId=t}},{key:"init",value:function(t){var a=this;this.bodySeg&&"custom-geometry"===this.bodySeg.props.type&&(this.bodySeg.path.geometry.vertices.forEach(function(t,e){var o=a.bodySeg.props.pathData.vertices[e];t.set(o.x,o.y,o.z)}),this.done=!!t,this.started=!1,this.count=0)}},{key:"setProps",value:function(t){var e=t.duration,o=t.toPath,a=t.startAt,i=t.pathId;if(this.bodySeg&&"custom-geometry"===this.bodySeg.props.type){this.duration=parseFloat(e),this.toPath=o,this.startAt=parseFloat(a),this.pathId=i;var n=JSON.parse(o),r=new THREE.ParametricGeometry(function(t,e,o){var a=t*n.height,i=e*n.width;o.set(a,i,0)},1,n.segments);r.vertices.forEach(function(t,e){var o=n.vertices[e];t.set(o.x,o.y,o.z)}),this.bodySeg,this.bodySeg.path.geometry.morphTargets[0]={name:"t1",vertices:r.vertices},this.bodySeg.path.geometry.computeMorphNormals(),this.bodySeg.path.updateMorphTargets()}}},{key:"animate",value:function(){var o=this;this.bodySeg&&!this.started?(this.init(),this.started=!0,this.bodySeg.path.geometry.vertices.forEach(function(t,e){window.animaticonObjects.AnimaticonUtils.animateVector3(o.bodySeg.path.geometry.vertices[e],o.bodySeg.path.geometry.morphTargets[0].vertices[e],{duration:1e3*o.duration,callback:o.onComplete}).start()})):this.bodySeg.path.geometry.verticesNeedUpdate=!0}},{key:"onComplete",value:function(){this.done=!0}},{key:"setStartAt",value:function(t){this.startAt=t}},{key:"setDuration",value:function(t){this.duration=parseFloat(t)}},{key:"getEndAt",value:function(){return this.startAt+this.duration}},{key:"getStartAt",value:function(){return this.startAt}},{key:"toJson",value:function(){return{duration:this.duration,startAt:this.startAt,animationControlClass:"PathAnimationControl3",toPath:this.toPath,pathId:this.pathId,groupId:this.group?this.group.groupId:null}}}]),h}();window.animaticonObjects.PathAnimationControl3=PathAnimationControl3;
"use strict";var _createClass=function(){function s(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var PathObj3=function(){function q(t){var e=this,i=t.path,s=t.pathData,r=void 0===s?{}:s,o=t.id,a=t.name,h=t.scene,p=t.type,n=void 0===p?"none":p,c=t.showDots,l=void 0!==c&&c,v=t.zIndex,u=void 0===v?10:v,y=t.group,f=t.visible,m=void 0===f||f,g=t.fillColor,d=void 0===g?0:g,x=t.position,E=void 0===x?{x:0,y:0,z:0}:x,z=t.rotation,b=void 0===z?{x:0,y:0,z:0}:z,w=t.scale,C=void 0===w?{x:1,y:1,z:1}:w,T=t.isCentered,D=void 0===T||T,H=t.applySceneBg,R=void 0!==H&&H,S=t.bcurve,k=void 0===S?null:S,P=t.dashSize,B=void 0===P?10:P,L=t.gapSize,O=void 0===L?3:L,M=t.text,j=void 0===M?null:M;if(_classCallCheck(this,q),this.bcurve=k,this.id=-1,this.scene=h,this.group=y,this.props={id:o,name:a,zIndex:u,fillColor:d,position:E,type:n,showDots:l,pathData:r,rotation:b,scale:C,visible:m,isCentered:D,applySceneBg:R,dashSize:B,gapSize:O,text:j},r&&!i)if("custom-geometry"===n){var A=new THREE.MeshBasicMaterial({morphTargets:!0,color:new THREE.Color(parseInt(this.props.fillColor)),side:THREE.DoubleSide}),I=new THREE.ParametricGeometry(function(t,e,i){var s=t*r.height,o=e*r.width;i.set(s,o,0)},r.hsegments||1,r.segments||r.vsegments);this.path=new THREE.Mesh(I,A)}else if("Line"===n){var G=new THREE.Path;G.moveTo(r.vertices[0].x,r.vertices[0].y),G.lineTo(r.vertices[1].x,r.vertices[1].y);var N=(new THREE.Geometry).setFromPoints(G.getPoints()),_=new THREE.LineDashedMaterial({color:parseInt(this.props.fillColor),dashSize:B,gapSize:O});this.path=new THREE.Line(N,_),this.path.computeLineDistances()}else if("CBCurve"===n){var F=r.vertices.map(function(t){return new THREE.Vector3(t.x,t.y,t.z)}),J=new(Function.prototype.bind.apply(THREE.CubicBezierCurve3,[null].concat(_toConsumableArray(F)))),V=(this.bcurve=J).getPoints(50),Z=(new THREE.Geometry).setFromPoints(V),U=new THREE.LineDashedMaterial({color:parseInt(this.props.fillColor),dashSize:B,gapSize:O});this.path=new THREE.Line(Z,U),this.path.computeLineDistances()}else{(new THREE.ObjectLoader).parse(JSON.parse(r),function(t){e.path=t})}else this.path=i;this.init(),this.scene.add(this.path),this.formZindexes(),this.formDots()}return _createClass(q,[{key:"init",value:function(){var t=this.props,e=t.position,i=t.rotation,s=(t.path,t.type),o=t.pathData,r=t.visible,a=t.scale;"custom-geometry"!==s&&"Line"!==s||!o.vertices||(this.path.geometry.vertices.forEach(function(t,e){var i=o.vertices[e];t.set(i.x,i.y,i.z)}),this.path.geometry.verticesNeedUpdate=!0),"Line"!==s&&this.props.isCentered&&this.path.geometry.center(),this.path.position.x=e.x,this.path.position.y=e.y,this.path.position.z=e.z,this.path.rotation.x=i.x,this.path.rotation.y=i.y,this.path.rotation.z=i.z,this.path.scale.x=a.x,this.path.scale.y=a.y,this.path.scale.z=a.z,this.path.visible=r}},{key:"updateProps",value:function(){this.props.scale={x:this.path.scale.x,y:this.path.scale.y,z:this.path.scale.z},this.props.position={x:this.path.position.x,y:this.path.position.y,z:this.path.position.z},this.props.rotation={x:this.path.rotation.x,y:this.path.rotation.y,z:this.path.rotation.z}}},{key:"showHideDots",value:function(t){var e=this;this.props.showDots=t,this.path.children.forEach(function(t){return t.visible=e.props.showDots})}},{key:"formDots",value:function(){var r=this;"custom-geometry"===this.props.type||"Line"===this.props.type?this.path.geometry.vertices.length>this.path.children.length&&this.props.showDots?this.path.geometry.vertices.forEach(function(t,e){var i=new THREE.MeshBasicMaterial({color:16711680,transparent:!1}),s=new THREE.SphereGeometry(3),o=new THREE.Mesh(s,i);o.name=e,o.position.copy(t),r.path.add(o)}):this.path.children.forEach(function(t){return t.visible=r.props.showDots}):"CBCurve"===this.props.type&&(this.props.pathData.vertices&&this.props.pathData.vertices.length>this.path.children.length&&this.props.showDots?this.props.pathData.vertices.forEach(function(t,e){var i=new THREE.MeshBasicMaterial({color:16711680,transparent:!1}),s=new THREE.SphereGeometry(3),o=new THREE.Mesh(s,i);o.name=e,o.position.x=t.x,o.position.y=t.y,o.position.z=t.z,r.path.add(o)}):this.path.children.forEach(function(t){return t.visible=r.props.showDots}))}},{key:"scaleDots",value:function(e){var i=this;0===this.path.children.length&&this.formDots(),this.props.showDots=!0,this.path.children.forEach(function(t){t.visible=i.props.showDots,t.scale.x+=0<t.scale.x?e:-e,t.scale.y+=0<t.scale.y?e:-e})}},{key:"getPointAt",value:function(t){if(this.curve)return this.curve.getPointAt(t);if(this.bcurve)return this.bcurve.getPointAt(t);if("Line"===this.props.type){var e=new THREE.Path;return this.props.pathData.vertices=null,e.moveTo(this.path.geometry.vertices[0].x,this.path.geometry.vertices[0].y),e.lineTo(this.path.geometry.vertices[1].x,this.path.geometry.vertices[1].y),this.curve=e,this.curve.getPointAt(t)}return null}},{key:"remove",value:function(){this.path.parent&&this.path.parent.remove(this.path)}},{key:"formZindexes",value:function(){this.path.position.z=this.props.zIndex}},{key:"setGroup",value:function(t){this.group=t,this.group.add(this.path)}},{key:"setProps",value:function(t){var r=this;if(this.props=Object.assign({},this.props,t),this.path.material.color=new THREE.Color(parseInt(this.props.fillColor)),this.formZindexes(),this.formDots(),"CBCurve"===this.props.type||"Line"===this.props.type)this.path.material.gapSize=this.props.gapSize,this.path.material.dashSize=this.props.dashSize;else if("CanvasText"===this.props.type){(new THREE.FontLoader).load("fonts/helvetiker_regular.typeface.json",function(t){var e=new THREE.TextBufferGeometry(r.props.text,{font:t,size:40,height:1,curveSegments:12,bevelEnabled:!0,bevelThickness:1,bevelSize:1,bevelSegments:1}),i=new THREE.MeshBasicMaterial({color:parseInt(r.props.fillColor)}),s=new THREE.Mesh(e,i);s.position.copy(r.path.position),s.scale.copy(r.path.scale),s.rotation.copy(r.path.rotation);var o=r.path.parent;o.add(s),o.remove(r.path),r.path=s,r.path.visible=r.props.visible})}}},{key:"setColor",value:function(t){var e=t.fillColor,i=(t.strokeColor,t.bgColor);this.props.applySceneBg&&i?(this.props.fillColor=i,this.path.material.color=new THREE.Color(parseInt(i))):e&&(this.props.fillColor=e,this.path.material.color=new THREE.Color(parseInt(e)))}},{key:"setPosition",value:function(t){this.path.position.x=t.x,this.path.position.y=t.y}},{key:"getBCurveVertices",value:function(){return[{x:this.bcurve.v0.x,y:this.bcurve.v0.y,z:this.bcurve.v0.z},{x:this.bcurve.v1.x,y:this.bcurve.v1.y,z:this.bcurve.v1.z},{x:this.bcurve.v2.x,y:this.bcurve.v2.y,z:this.bcurve.v2.z},{x:this.bcurve.v3.x,y:this.bcurve.v3.y,z:this.bcurve.v3.z}]}},{key:"getProperties",value:function(){return"custom-geometry"===this.props.type||"Line"===this.props.type?this.props.pathData.vertices||(this.props.pathData.vertices=this.path.geometry.vertices.map(function(t){return{x:t.x,y:t.y,z:t.z}})):"CBCurve"===this.props.type?this.props.pathData={vertices:this.getBCurveVertices()}:this.props.pathData=JSON.stringify(this.path.toJSON()),this.props=Object.assign({},this.props,{position:{x:this.path.position.x,y:this.path.position.y,z:this.path.position.z},rotation:{x:this.path.rotation.x,y:this.path.rotation.y,z:this.path.rotation.z},scale:{x:this.path.scale.x,y:this.path.scale.y,z:this.path.scale.z},zIndex:this.path.position.z,fillColor:"0x"+this.path.material.color.getHexString(),visible:this.path.visible}),this.props}},{key:"getPathData",value:function(){return"custom-geometry"===this.props.type||"Line"===type?this.props.pathData.vertices=this.path.geometry.vertices.map(function(t){return{x:t.x,y:t.y,z:t.z}}):"CBCurve"===this.props.type||(this.props.pathData=JSON.stringify(this.path.toJSON())),this.props.pathData}},{key:"setVertex",value:function(t,e,i){if(t.position.x+=e.x,t.position.y+=e.y,"CBCurve"===this.props.type&&this.bcurve){this.bcurve["v"+t.name].x+=e.x,this.bcurve["v"+t.name].y+=e.y;var s=this.bcurve.getPoints(50);this.path.geometry.setFromPoints(s)}else this.path.geometry.vertices[t.name].x+=e.x,this.path.geometry.vertices[t.name].y+=e.y,this.path.geometry.verticesNeedUpdate=!0;this.curve=null}},{key:"clone",value:function(){var t=this.getProperties();return t.position.x+=30,t.position.y+=30,t.id+="1",t.name+="1",t.scene=this.scene,new window.animaticonObjects.PathObj3(t)}},{key:"getAngle",value:function(){return this.path.rotation.z}},{key:"rotatePath",value:function(t){this.path.rotation.z=t}}]),q}();window.animaticonObjects.PathObj3=PathObj3;
"use strict";var _createClass=function(){function i(t,n){for(var o=0;o<n.length;o++){var i=n[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,n,o){return n&&i(t.prototype,n),o&&i(t,o),t}}();function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var RotateAnimationControl3=function(){function l(t){var n=this,o=t.duration,i=t.from,e=t.angle,a=t.startAt,s=t.group,r=t.groupItem,u=t.id,h=t.groupId;_classCallCheck(this,l),this.animationControlClass="RotateAnimationControl3",this.done=!1,this.rotatedAngle=0,this.id=u,this.group=s,this.groupItem=r,this.group&&(this.bodySeg=this.group.bones.find(function(t){return t.props.id===n.groupItem}).bone),this.setProps({duration:o,from:i,angle:e,startAt:a}),this.groupId=h,this.onComplete=this.onComplete.bind(this)}return _createClass(l,[{key:"setId",value:function(t){this.id=t}},{key:"setScrean",value:function(t){this.screen=t}},{key:"setGroupId",value:function(t){this.groupId=t}},{key:"init",value:function(){this.bodySeg&&(this.bodySeg.rotation.z=this.from),this.done=!1,this.rotatedAngle=0,this.started=!1}},{key:"setProps",value:function(t){var n=t.duration,o=t.from,i=t.angle,e=t.startAt;this.duration=parseFloat(n),this.from=parseFloat(o),this.angle=parseFloat(i),this.to=this.angle/(60*this.duration),this.startAt=parseFloat(e),this.tween=null}},{key:"animate",value:function(){!this.started&&this.bodySeg&&(this.init(),this.started=!0,this.tween||(this.tween=window.animaticonObjects.AnimaticonUtils.animateVector3(this.bodySeg.rotation,{z:this.from+this.angle},{duration:1e3*this.duration,callback:this.onComplete})),this.tween.start())}},{key:"onComplete",value:function(){this.done=!0}},{key:"setStartAt",value:function(t){this.startAt=t}},{key:"setDuration",value:function(t){this.duration=parseFloat(t),this.tween=null}},{key:"getEndAt",value:function(){return this.startAt+this.duration}},{key:"getStartAt",value:function(){return this.startAt}},{key:"showHideRotationPoints",value:function(n){this.bones.forEach(function(t){return t.showHideRotationPoints(n)})}},{key:"toJson",value:function(){return{duration:this.duration,from:this.from,angle:this.angle,startAt:this.startAt,animationControlClass:"RotateAnimationControl3",groupItem:this.groupItem,groupId:this.group.groupId}}},{key:"toRadians",value:function(t){return t*(Math.PI/180)}}]),l}();window.animaticonObjects.RotateAnimationControl3=RotateAnimationControl3;
"use strict";var _createClass=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var SpeechAnimationControl3=function(){function a(t){var e=t.duration,i=t.msg,n=t.startAt,s=t.id,o=t.voice;_classCallCheck(this,a),this.animationControlClass="SpeechAnimationControl3",this.done=!1,this.id=s,this.setProps({duration:e,msg:i,startAt:n,voice:o}),this.onComplete=this.onComplete.bind(this)}return _createClass(a,[{key:"setId",value:function(t){this.id=t}},{key:"setScrean",value:function(t){this.screen=t}},{key:"init",value:function(){var e=this;this.done=!1,this.started=!1;var t=window.speechSynthesis.getVoices();this.gVoice=t.find(function(t){return t.voiceURI===e.voice})}},{key:"setProps",value:function(t){var e=t.duration,i=t.msg,n=t.startAt,s=t.voice;this.duration=parseFloat(e),this.voice=s,this.msg=i,this.startAt=parseFloat(n)}},{key:"animate",value:function(){if(!this.started){this.init(),this.started=!0;var t=new SpeechSynthesisUtterance;window.speechSynthesis.getVoices();t.voice=this.gVoice,t.text=this.msg,t.onend=this.onComplete,window.speechSynthesis.speak(t)}}},{key:"onComplete",value:function(){this.done=!0}},{key:"setStartAt",value:function(t){this.startAt=t}},{key:"setDuration",value:function(t){this.duration=parseFloat(t)}},{key:"getEndAt",value:function(){return this.startAt+this.duration}},{key:"getStartAt",value:function(){return this.startAt}},{key:"toJson",value:function(){return{duration:this.duration,startAt:this.startAt,msg:this.msg,voice:this.voice,animationControlClass:"SpeechAnimationControl3"}}}]),a}();window.animaticonObjects.SpeechAnimationControl3=SpeechAnimationControl3;
"use strict";var _createClass=function(){function a(t,n){for(var i=0;i<n.length;i++){var a=n[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,n,i){return n&&a(t.prototype,n),i&&a(t,i),t}}();function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var TranslateAnimationControl3=function(){function u(t){var n=t.duration,i=t.pathItem,a=t.startAt,e=t.group,o=t.id,s=t.translatePath,r=t.groupId;_classCallCheck(this,u),this.animationControlClass="TranslateAnimationControl3",this.done=!1,this.translatePath=s,this.id=o,this.group=e,s||(this.translatePath=this.group.paths.find(function(t){return t.props.id===i})),this.setProps({duration:n,pathItem:i,startAt:a}),this.groupId=r,this.onComplete=this.onComplete.bind(this)}return _createClass(u,[{key:"setId",value:function(t){this.id=t}},{key:"setScrean",value:function(t){this.screen=t}},{key:"setGroupId",value:function(t){this.groupId=t}},{key:"init",value:function(){this.done=!1,this.started=!1,this.initToStart()}},{key:"initToStart",value:function(){var t=this.translatePath.getPointAt(0);this.group.group.position.x=t.x,this.group.group.position.y=t.y}},{key:"setProps",value:function(t){var n=t.duration,i=t.pathItem,a=t.startAt;this.duration=parseFloat(n),this.pathItem=i,this.startAt=parseFloat(a)}},{key:"animate",value:function(){if(this.done||this.started)this.group.group.position.needUpdate=!0;else{this.init(),this.started=!0;var t=this.translatePath.getPointAt(1);this.tween=window.animaticonObjects.AnimaticonUtils.animateVector3(this.group.group.position,{x:t.x,y:t.y},{duration:1e3*this.duration,callback:this.onComplete}),this.tween.start()}}},{key:"onComplete",value:function(){this.done=!0}},{key:"setStartAt",value:function(t){this.startAt=t}},{key:"setDuration",value:function(t){this.duration=parseFloat(t),this.tween=null}},{key:"getEndAt",value:function(){return this.startAt+this.duration}},{key:"getStartAt",value:function(){return this.startAt}},{key:"toJson",value:function(){return{duration:this.duration,startAt:this.startAt,animationControlClass:"TranslateAnimationControl3",pathItem:this.pathItem,groupId:this.group.groupId}}}]),u}();window.animaticonObjects.TranslateAnimationControl3=TranslateAnimationControl3;
"use strict";var _createClass=function(){function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,i,e){return i&&n(t.prototype,i),e&&n(t,e),t}}();function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var VectorAnimationControl3=function(){function r(t){var i=t.duration,e=t.to,n=t.startAt,o=t.group,s=t.id,a=(t.groupId,t.type);_classCallCheck(this,r),this.animationControlClass="VectorAnimationControl3",this.done=!1,this.scaledLength=0,this.id=s,this.group=o,this.setProps({duration:i,to:e,startAt:n,type:a}),this.onComplete=this.onComplete.bind(this)}return _createClass(r,[{key:"setId",value:function(t){this.id=t}},{key:"setScrean",value:function(t){this.screen=t}},{key:"setGroupId",value:function(t){this.groupId=t}},{key:"init",value:function(){this.done=!1,this.scaledLength=0,this.started=!1;var t=this.group.group?this.group.group:this.group;this.initScale&&(t[this.type].x=this.initScale.x,t[this.type].y=this.initScale.y,t[this.type].z=this.initScale.z)}},{key:"setProps",value:function(t){var i=t.duration,e=t.to,n=t.startAt,o=t.type;this.duration=parseFloat(i),this.to=e,this.type=o;var s=e.split(",");this.scaleTo={x:parseFloat(s[0]),y:parseFloat(s[1]),z:parseFloat(s[2])},this.startAt=parseFloat(n),this.tween=null}},{key:"animate",value:function(){if(!this.started){if(this.init(),this.started=!0,!this.tween){var t=this.group.group?this.group.group:this.group;this.initScale=t[this.type].clone(),this.tween=window.animaticonObjects.AnimaticonUtils.animateVector3(t[this.type],this.scaleTo,{duration:1e3*this.duration,callback:this.onComplete})}this.tween.start()}}},{key:"onComplete",value:function(){this.done=!0}},{key:"setStartAt",value:function(t){this.startAt=t}},{key:"setDuration",value:function(t){this.duration=parseFloat(t),this.tween=null}},{key:"getEndAt",value:function(){return this.startAt+this.duration}},{key:"getStartAt",value:function(){return this.startAt}},{key:"toJson",value:function(){return{duration:this.duration,to:this.to,type:this.type,startAt:this.startAt,animationControlClass:"VectorAnimationControl3",groupId:this.group.groupId}}}]),r}();window.animaticonObjects.VectorAnimationControl3=VectorAnimationControl3;
"use strict";var _createClass=function(){function e(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var VisibilityAnimationControl3=function(){function a(t){var i=t.duration,n=t.visible,e=t.startAt,s=t.group,o=t.id,r=t.groupId;_classCallCheck(this,a),this.animationControlClass="VisibilityAnimationControl3",this.done=!1,this.id=o,this.group=s,this.setProps({duration:i,visible:n,startAt:e}),this.groupId=r}return _createClass(a,[{key:"setGroupId",value:function(t){this.groupId=t}},{key:"setId",value:function(t){this.id=t}},{key:"setScrean",value:function(t){this.screen=t}},{key:"init",value:function(){this.group.group.visible=!0}},{key:"setProps",value:function(t){var i=t.duration,n=t.visible,e=t.startAt;this.duration=parseFloat(i),this.visible=n,this.startAt=e}},{key:"animate",value:function(){this.group.group.visible=this.visible,this.done=!0}},{key:"setStartAt",value:function(t){this.startAt=t}},{key:"setDuration",value:function(t){this.duration=parseFloat(t)}},{key:"getEndAt",value:function(){return this.startAt+this.duration}},{key:"getStartAt",value:function(){return this.startAt}},{key:"toJson",value:function(){return{duration:this.duration,visible:this.visible,startAt:this.startAt,animationControlClass:"VisibilityAnimationControl3",groupId:this.group.groupId}}}]),a}();window.animaticonObjects.VisibilityAnimationControl3=VisibilityAnimationControl3;